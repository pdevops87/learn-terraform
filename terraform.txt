IaC:
----
Infrastructure as Code (IaC) is used to define and manage infrastructure such as servers, networks, and databases. Earlier, this was done manually, but with IaC we write configuration files in a machine-readable format instead of configuring everything by hand.

With IaC, your infrastructure becomes:

Automated – deployments happen through code execution

Consistent – no manual mistakes or “it works on my machine”

Version-controlled – stored in Git like software code

Repeatable – recreate environments anytime (dev → test → prod)

file:
----
resource "aws_instance" "web" {
  ami           = "ami-123456"
  instance_type = "t2.micro"
}
this file defines a server .Running terraform o create it.

imperative and declarative:
===========================
Imperative means describing the steps to reach the goal.
Declarative means describing the desired end state without specifying the steps or order.
Provider:
=========
In Terraform, a provider is a plugin that allows Terraform to communicate with a specific platform or service — such as AWS, Azure, Google Cloud, VMware, GitHub, etc.
A provider is a plugin that Terraform uses to interact with a specific cloud or service (like AWS or Azure).
Users supply inputs in HCL → the provider translates those inputs into API calls → AWS/Azure/GCP create the resources.
Your HCL Inputs  →  Terraform Engine  →  Provider Plugin  →  AWS/Azure API


1.Terraform is a tool
2.HCL is a hashicorp language to write the code for terraform tool
3.Terraform is used to create the infrastructure and managing the servers


ls -A
ls .terraform
install terraform:
==================
sudo yum install -y yum-utils
sudo yum-config-manager --add-repo https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo
sudo yum -y install terraform
resource "<PROVIDER>_<RESOURCE_TYPE>" "<RESOURCE_LABEL>" {
  # configuration
}
* provider is a plugin to interact with cloud services like aws ,azure,...
* our service is aws
* here provider interacts with aws service
provider provides resource block,resource types like aws_instance and resource labels(provided by end users)

02-12-2025
-----------
static values:
==============
resource aws_instance "frontend"{
ami="a312311"
}
avoid giving static value every time. to pass value as dynamic by using variable

resource aws_instance "frontend"{
ami = ""
}
resource aws_instance  "cart"{
ami = ""
}
resource aws_instance "catalogue"{
ami = ""
}
suppose to create n number of instances , keeping to write each and every resource independently is not a good, and it is a challenge work.
to avoid this duplicate use count
**resource aws_instance "components"{
count = 5
ami = ""
}
here count = 5 , to create number of resources as 5[ec2 instance]

we can go for another loop as for_each

resource aws_instance "components"{
for_each = var.components
ami = each/value["ami"]
tags = {
Name = each.key
}
}
variable components{
default = {
frontend = t3.micro
}
}
here variable components assign to for_each loop, here components is declared as map and call each pair as key and value.

Provisioner:
=============
* provisioner is not loaded properly in specific resource that resource will taint and destroy a resource then recreate when we run terraform, so it tainted/replaced old instance to new instance
Terraform destroys the old instance
Terraform creates a new one
The provisioner runs again on the new instance
** suppose create a provisioner inside instance,and then next  create route53 records .
** terraform will complete instance creation and connect to remote node through provisioner , once complete the execution then only route 53 records will create.
** provisioner successfully completes does Terraform consider the resource “healthy” and stops replacing it.
** Terraform does not track provisioner content as part of the resource state. means once script executes successfully when terraform creates a resource time, if we change any update terraform won't detect the changes in existing resource just display a message as "no changes in an Infrastructure"
** provisioner run only one time,Terraform will NOT rerun the provisioner
** Terraform does not track provisioner execution in the state. Once a provisioner successfully executes during resource creation, changing the script later will not update or rerun it. Only a tainted or replaced resource will rerun it.
here state means: terraform.tfstate


When we say “Terraform does not track provisioner execution in the state,” it means:
=====================================================================================
Terraform only tracks the resource itself in the state
Terraform does not remember what the provisioner did
Therefore, changes to the provisioner alone do not trigger updates

ex:
resource "aws_instance" "example" {
  ami           = "ami-123456"
  instance_type = "t2.micro"

  provisioner "remote-exec" {
    inline = ["echo 'Hello World'"]
  }
}
terraform apply Hello World is the output

resource "aws_instance" "example" {
  ami           = "ami-123456"
  instance_type = "t2.micro"

  provisioner "remote-exec" {
    inline = ["echo 'updated script'"]
  }
}
terraform apply : No changes. Infrastructure is up-to-date.
                  Provisioner does NOT run
                  Instance stays the same
here two problems:
===================
1.resources are tainted when we rerun to terraform, tainted means replace.
if provisioner not able to run properly in an instance then it resources will destroy and recreate.
2.once instance creation and provisioner execution completes then only next resource will create.


cloud-init:
-----------
/etc/cloud/cloud.cfg
* create an ec2 instances by using resource block
* to create a multiple instance also by using resource block

04-12-2025:
-----------

